# PostgreSQL External Access via NodePort
#
# Simple approach - no changes to ingress needed.
#
# Exposes:
#   - db.lumapos.co:30432      -> prod PostgreSQL
#   - dev.db.lumapos.co:30433  -> dev PostgreSQL
#
# =============================================================================
# INSTALLATION:
# =============================================================================
#   kubectl apply -f postgres-external.yaml
#
# =============================================================================
# ROUTE 53 Configuration:
# =============================================================================
#   - db.lumapos.co -> Your server IP (clients connect on port 30432)
#   - dev.db.lumapos.co -> Your server IP (clients connect on port 30433)
#
# =============================================================================
# CONNECTION STRINGS:
# =============================================================================
#   Prod: postgresql://luma:PASSWORD@db.lumapos.co:30432/luma_db
#   Dev:  postgresql://luma:PASSWORD@dev.db.lumapos.co:30433/luma_db
#
# =============================================================================

---
apiVersion: v1
kind: Service
metadata:
  name: postgres-external
  namespace: prod
  labels:
    app: postgres
spec:
  type: NodePort
  selector:
    app: postgres
  ports:
  - name: postgres
    port: 5432
    targetPort: 5432
    nodePort: 30432
    protocol: TCP

---
apiVersion: v1
kind: Service
metadata:
  name: postgres-external
  namespace: dev
  labels:
    app: postgres
spec:
  type: NodePort
  selector:
    app: postgres
  ports:
  - name: postgres
    port: 5432
    targetPort: 5432
    nodePort: 30433
    protocol: TCP
